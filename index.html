<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>LPWAN Static Context Header Compression (SCHC) for CoAP</title>

  
<style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    padding: 0 1em;
    z-index: 1;
  }
  #rfc\.toc {
    top: 16px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
  }

  body {
    padding-left: 1.5em;
    padding-right: 29em;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 2.5em auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc ul {
  margin: 0;
}
/* xml2rfc nests ul directly inside ul which messes with the style badly */
ul.toc, ul.toc>ul, ul.toc ul>ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}
address {
  font-style: normal;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 CoAP Compressing">
<link href="#rfc.section.3" rel="Chapter" title="3 Compression of CoAP header fields">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 CoAP version field (2 bits)">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 CoAP type field">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 CoAP token length field">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 CoAP code field">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 CoAP Message ID field">
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 CoAP Token field">
<link href="#rfc.section.4" rel="Chapter" title="4 CoAP options">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 CoAP option Content-format field.">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 CoAP option Accept field">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 CoAP option Max-Age field, CoAP option Uri-Host and Uri-Port fields">
<link href="#rfc.section.5" rel="Chapter" title="5 CoAP option Uri-Path and Uri-Query fields">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 CoAP option Proxy-URI and Proxy-Scheme fields">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 CoAP option ETag, If-Match, If-None-Match, Location-Path and Location-Query fields">
<link href="#rfc.section.6" rel="Chapter" title="6 Other RFCs">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Block">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Observe">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 No-Response">
<link href="#rfc.section.7" rel="Chapter" title="7 Protocol analysis">
<link href="#rfc.section.8" rel="Chapter" title="8 Examples of CoAP header compression">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 Mandatory header with CON message">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 Complete exchange">
<link href="#rfc.references" rel="Chapter" title="9 Normative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.8.0 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Minaburo, A. and L. Toutain" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-lpwan-coap-static-context-hc-02" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-9-06" />
  <meta name="dct.abstract" content="This draft defines the way SCHC header compression can be applied to CoAP headers.  CoAP header structure differs from IPv6 and UDP protocols since the CoAP Header is flexible header with a variable number of options themself of a variable length.  Another important difference is the asymmetry in the header information used for request and response messages. This draft takes into account the fact that a thing can play the role of a CoAP client, a CoAP client or both roles." />
  <meta name="description" content="This draft defines the way SCHC header compression can be applied to CoAP headers.  CoAP header structure differs from IPv6 and UDP protocols since the CoAP Header is flexible header with a variable number of options themself of a variable length.  Another important difference is the asymmetry in the header information used for request and response messages. This draft takes into account the fact that a thing can play the role of a CoAP client, a CoAP client or both roles." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">lpwan Working Group</td>
<td class="right">A. Minaburo</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Acklio</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">L. Toutain</td>
</tr>
<tr>
<td class="left">Expires: March 10, 2018</td>
<td class="right">Institut MINES TELECOM ; IMT Atlantique</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">September 06, 2017</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">LPWAN Static Context Header Compression (SCHC) for CoAP<br />
  <span class="filename">draft-ietf-lpwan-coap-static-context-hc-02</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This draft defines the way SCHC header compression can be applied to CoAP headers.  CoAP header structure differs from IPv6 and UDP protocols since the CoAP Header is flexible header with a variable number of options themself of a variable length.  Another important difference is the asymmetry in the header information used for request and response messages. This draft takes into account the fact that a thing can play the role of a CoAP client, a CoAP client or both roles.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on March 10, 2018.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2017 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">CoAP Compressing</a>
</li>
<li>3.   <a href="#rfc.section.3">Compression of CoAP header fields</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">CoAP version field (2 bits)</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">CoAP type field</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">CoAP token length field</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">CoAP code field</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">CoAP Message ID field</a>
</li>
<li>3.6.   <a href="#rfc.section.3.6">CoAP Token field</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">CoAP options</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">CoAP option Content-format field.</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">CoAP option Accept field</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">CoAP option Max-Age field, CoAP option Uri-Host and Uri-Port fields</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">CoAP option Uri-Path and Uri-Query fields</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">CoAP option Proxy-URI and Proxy-Scheme fields</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">CoAP option ETag, If-Match, If-None-Match, Location-Path and Location-Query fields</a>
</li>
</ul><li>6.   <a href="#rfc.section.6">Other RFCs</a>
</li>
<ul><li>6.1.   <a href="#rfc.section.6.1">Block</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Observe</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">No-Response</a>
</li>
</ul><li>7.   <a href="#rfc.section.7">Protocol analysis</a>
</li>
<li>8.   <a href="#rfc.section.8">Examples of CoAP header compression</a>
</li>
<ul><li>8.1.   <a href="#rfc.section.8.1">Mandatory header with CON message</a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">Complete exchange</a>
</li>
</ul><li>9.   <a href="#rfc.references">Normative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#Introduction" id="Introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">CoAP <a href="#rfc7252" class="xref">[rfc7252]</a> is an implementation of the REST architecture for constrained devices. Gateway between CoAP and HTTP can be easily built since both protocols uses the same address space (URL), caching mechanisms and methods.</p>
<p id="rfc.section.1.p.2">Nevertheless, if limited, the size of a CoAP header may be too large for LPWAN constraints and some compression may be needed to reduce the header size.</p>
<p><a href="#I-D.toutain-lpwan-ipv6-static-context-hc" class="xref">[I-D.toutain-lpwan-ipv6-static-context-hc]</a> defines a header compression mechanism for LPWAN network based on a static context. The context is said static since the element values composing the context are not learned during the packet exchanges but are previously defined.  The context(s) is(are) known by both ends before transmission.</p>
<p id="rfc.section.1.p.4">A context is composed of a set of rules (contexts) that are referenced by Rule IDs (identifiers).  A rule contains an ordered list of the header fields containing &#224; field ID (FID) and its position when repeated, a direction indicator (DI) (upstream, downstream and bidirectional) and some associated Target Values (TV) which are expected in the message header. A Matching Operator (MO) is associated to each header field description. The rule is selected if all the MOs fit the TVs.  In that case, a Compression Decompression Function (CDF) associated to each field defines the link between the compressed and decompressed value for each of the header fields.</p>
<pre>
This document describes how the rules can be applied to CoAP flows. Compression of the 
CoAP header may be done in conjunction with the above layers or independantly.
</pre>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#coap-compressing" id="coap-compressing">CoAP Compressing</a>
</h1>
<p id="rfc.section.2.p.1">CoAP differs from IPv6 and UDP protocols on the following <br> aspects:</p>
<p></p>

<ul>
<li>IPv6 and UDP are symmetrical protocols. The same fields are found in the request and in the response, only location in the header may vary (e.g. source and destination fields). A CoAP request is different from  an response. For example, the URI-path option is mandatory in the request and is not found in the response, request may contain an Accept option and the response a Content-format option.  <br><br> Even when a field is &#8220;symmetric&#8221; (i.e. found in both directions) the values carried are different. For instance the Type field will contain a CON value in the request and a ACK or RST value in the response. Exploiting the asymmetry in compression will allow to send no bit in the compressed request and a single bit in the answer. Same behavior can be applied to the CoAP Code field (O.OX code are present in the request and Y.ZZ in the answer).</li>
<li>CoAP also obeys to the client/server paradigm and the compression rate can be different if the request is issued from a LPWAN node or from an non LPWAN device. For instance a Thing (ES) aware of LPWAN constraints can generate a 1 byte token, but a regular CoAP client will certainly send a larger token to the Thing. SCHC compression will not modify the values to offer a better compression rate. Nevertheless a proxy placed before the compressor may change some field values to offer a better compression rate and maintain the necessary context for interoperability with existing CoAP implementations.</li>
<li>In IPv6 and UDP header fields have a fixed size. In CoAP, Token size may vary from 0 to 8 bytes, length is given by a field in the header. More systematically, the CoAP options are described using the Type-Length-Value.  When applying SCHC header compression.  <br><br> By sending compressed field information following the rule order, SCHC offers a serialization/deserialization mechanism. Since a field exists to indicate the token length there is no ambiguity. For options, the rule indicates also the expected options found the int CoAP header. Therefore only the length is needed to recognise an option.  The length will be send using the same CoAP encoding (size less than 12 are directly sent, higher values uses the escape mechanisms defined by <a href="#rfc7252" class="xref">[rfc7252]</a>). Delta Type is omitted, the value will be recovered by the decompressor. This reduce the option length of 4, 12 or 20 bits regarding the orignial size of the delta type encoding in the option.</li>
<li>In CoAP headers a field can be duplicated several times, for instances, elements of an URI (path or queries) or accepted formats. The position defined in a rule, associated to a Field ID, can be used to identify the proper element.</li>
</ul>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#compression-of-coap-header-fields" id="compression-of-coap-header-fields">Compression of CoAP header fields</a>
</h1>
<p id="rfc.section.3.p.1">This section discusses of the compression of the different CoAP header fields. These are just examples. The compression should take into account the nature of the traffic and not only the field values. Next chapter will define some compression rules for some common exchanges.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#coap-version-field-2-bits" id="coap-version-field-2-bits">CoAP version field (2 bits)</a>
</h1>
<p id="rfc.section.3.1.p.1">This field is bidirectional and can be elided during the SCHC compression, since it always contains  the same value. It appears only in first position.</p>
<pre>
FID      Pos    DI    TV              MO             CDF
ver      1      bi    1               equal          not-sent
</pre>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#coap-type-field" id="coap-type-field">CoAP type field</a>
</h1>
<p id="rfc.section.3.2.p.1">This field can be managed bidirectionally or unidirectionally.Several strategies can be applied to this field regarding the values used:</p>
<p></p>

<ul><li>If the ES is a client or a Server and non confirmable message are used, the transmission of the Type field can be avoided:  <ul>
<li>Pos is always 1,</li>
<li>DI can either be &#8220;uplink&#8221; if the ES is a CoAP client or &#8220;downlink&#8221; if the ES is a CoAP server, or &#8220;bidirectional&#8221;</li>
<li>TV is set to the  value,</li>
<li>MO is set to &#8220;equal&#8221;</li>
<li>CDF is set to &#8220;not-sent&#8221;.</li>
</ul>
</li></ul>
<pre>
FID     Pos    DI    TV              MO             CDF
type    1      bi    NON             equal          not-sent
</pre>
<p></p>

<ul><li>If the ES is either a client or a Server and confirmable message are used, the DI can be used to elide the type on the request and compress it to 1 bit on the response.  The example above shows the rule for a ES acting as a client, directions need to be reversed for a ES acting as a server.</li></ul>
<pre>
FID     Pos    DI    TV              MO             CDF
type    1      up    CON             equal          not-sent
type    1      dw    {0:ACK, 1:RST}  match-mapping  mapping-sent
</pre>
<p></p>

<ul><li>Otherwise if the ES is acting simultaneously as a client and a server and the rule handle these two traffics, Type field must be sent uncompressed.</li></ul>
<pre>
FID     Pos    DI    TV              MO             CDF
type    1      bi                    ignore         send-value
</pre>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#coap-token-length-field" id="coap-token-length-field">CoAP token length field</a>
</h1>
<p id="rfc.section.3.3.p.1">This field is bi-directional.</p>
<p id="rfc.section.3.3.p.2">Several strategies can be applied to this field regarding the values:</p>
<p></p>

<ul><li>no token or a wellknown length, the transmission can be avoided. A special care must be taken, if CON messages are acknowledged with an empty ACK message. In that case the token is not always present.</li></ul>
<pre>
FID     Pos    DI    TV              MO             CDF
TKL     1      bi    value           ignore         send-value
</pre>
<p></p>

<ul><li>If the length is changing from one message to an other, the Token Length field must be sent. If the Token length can be limited, then only the least significant bits have to be sent. The example below allows values between 0 and 3.</li></ul>
<pre>
FID    Pos    DI    TV              MO             CDF
TKL    1      bi    0x0             MSB(2)         LSB(2)
</pre>
<p></p>

<ul><li>otherwise the field value has to be sent.</li></ul>
<pre>
FID     Pos    DI    TV              MO             CDF
TKL     1      bi                    ignore         value-sent
</pre>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#coap-code-field" id="coap-code-field">CoAP code field</a>
</h1>
<p id="rfc.section.3.4.p.1">This field is bidirectional, but compression can be enhanced using DI.</p>
<p id="rfc.section.3.4.p.2">The CoAP Code field defines a tricky way to ensure compatibility with HTTP values.  Nevertheless only 21 values are defined by <a href="#rfc7252" class="xref">[rfc7252]</a> compared to the 255 possible values.</p>
<div id="rfc.figure.1"></div>
<div id="Fig--example-code-mapping"></div>
<pre>
               +------+------------------------------+-----------+
               | Code | Description                  | Mapping   |
               +------+------------------------------+-----------+
               | 0.00 |                              |  0x00     |
               | 0.01 | GET                          |  0x01     |
               | 0.02 | POST                         |  0x02     |
               | 0.03 | PUT                          |  0x03     |
               | 0.04 | DELETE                       |  0x04     |
               | 0.05 | FETCH                        |  0x05     |
               | 0.06 | PATCH                        |  0x06     |
               | 0.07 | iPATCH                       |  0x07     |
               | 2.01 | Created                      |  0x08     |
               | 2.02 | Deleted                      |  0x09     |
               | 2.03 | Valid                        |  0x0A     |
               | 2.04 | Changed                      |  0x0B     |
               | 2.05 | Content                      |  0x0C     |
               | 4.00 | Bad Request                  |  0x0D     |
               | 4.01 | Unauthorized                 |  0x0E     |
               | 4.02 | Bad Option                   |  0x0F     |
               | 4.03 | Forbidden                    |  0x10     |
               | 4.04 | Not Found                    |  0x11     |
               | 4.05 | Method Not Allowed           |  0x12     |
               | 4.06 | Not Acceptable               |  0x13     |
               | 4.12 | Precondition Failed          |  0x14     |
               | 4.13 | Request Entity Too Large     |  0x15     |
               | 4.15 | Unsupported Content-Format   |  0x16     |
               | 5.00 | Internal Server Error        |  0x17     |
               | 5.01 | Not Implemented              |  0x18     |
               | 5.02 | Bad Gateway                  |  0x19     |
               | 5.03 | Service Unavailable          |  0x1A     |
               | 5.04 | Gateway Timeout              |  0x1B     |
               | 5.05 | Proxying Not Supported       |  0x1C     |
               +------+------------------------------+-----------+

</pre>
<p class="figure">Figure 1: Example of CoAP code mapping</p>
<p><a href="#Fig--example-code-mapping" class="xref">Figure 1</a> gives a possible mapping, it can be changed to add new codes or reduced if some values are never used by both ends.  It could efficiently be coded on 5 bits.</p>
<p id="rfc.section.3.4.p.4">Even if the number of code can be increase with other RFC, implementations may use a limited number of values, which can help to reduce the number of bits sent on the LPWAN.</p>
<p id="rfc.section.3.4.p.5">The number of code may vary over time, some new codes may be introduced or some applications use a limited number of values.</p>
<p id="rfc.section.3.4.p.6">The client and the server do not use the same values. This asymmetry can be exploited to reduce the size sent on the LPWAN.</p>
<p id="rfc.section.3.4.p.7">The field can be treated differently in upstream than in downstream.  If the Thing is a client an entry can be set on the uplink message with a code matching for 0.0X values and another for downlink values for Y.ZZ codes.  It is the opposite if the thing is a server.</p>
<p id="rfc.section.3.4.p.8">If the ES always sends or receives requests with the same method, the Code field can be elided. The entry below shows a rule for a client sending only GET request.</p>
<pre>
FID     Pos    DI    TV              MO             CDF
code    1      up    GET             equal          not-sent
</pre>
<p id="rfc.section.3.4.p.9">If the client may send different methods, a matching-list can be applied. For table <a href="#Fig--example-code-mapping" class="xref">Figure 1</a>, 3 bits are necessary, but it could be less if fewer methods are used. Example below gives an example where the ES is a server and receives only GET and POST requests.</p>
<pre>
FID     Pos    DI    TV              MO             CDF
code    1      dw    {0:0.01, 1:0.02}match-mapping  mapping-sent
</pre>
<p id="rfc.section.3.4.p.10">The same approach can be applied to responses.</p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#coap-message-id-field" id="coap-message-id-field">CoAP Message ID field</a>
</h1>
<p id="rfc.section.3.5.p.1">This field is bidirectional.</p>
<p id="rfc.section.3.5.p.2">Message ID is used for two purposes:</p>
<p></p>

<ul>
<li>To acknowledge a CON message with an ACK.</li>
<li>To avoid duplicate messages.</li>
</ul>
<p id="rfc.section.3.5.p.4">In LPWAN, since a message can be received by several radio gateway, some LPWAN technologies include a sequence number in L2 to avoid duplicate frames. Therefore if the message does not need to be acknowledged (NON or RST message), the Message ID field can be avoided.</p>
<pre>
FID     Pos    DI    TV              MO             CDF
Mid     1      bi                    ignore         not-sent
</pre>
<p id="rfc.section.3.5.p.5">The decompressor must generate a value.</p>
<p id="rfc.section.3.5.p.6">[[Note; check id this field is not used by OSCOAP .]]</p>
<p id="rfc.section.3.5.p.7">To optimize information sent on the LPWAN, shorter values may be used during the exchange, but Message ID values generated a common CoAP implementation will not take into account this limitation. Before the compression, a proxy may be needed to reduce the size.</p>
<pre>
FID     Pos    DI    TV              MO             CDF
Mid     1      bi    0x0000          MSB(12)        LSB(4)
</pre>
<p id="rfc.section.3.5.p.8">Otherwise if no compression is possible, the field has to be sent</p>
<pre>
FID     Pos    DI    TV              MO             CDF
Mid     1      bi                    ignore         value-sent
</pre>
<h1 id="rfc.section.3.6">
<a href="#rfc.section.3.6">3.6.</a> <a href="#coap-token-field" id="coap-token-field">CoAP Token field</a>
</h1>
<p id="rfc.section.3.6.p.1">This field is bi-directional.</p>
<p id="rfc.section.3.6.p.2">Token is used to identify transactions and varies from one transaction to another.  Therefore, it is usually necessary to send the value of the token field on the LPWAN network.  The optimization will occur by using small values.</p>
<p id="rfc.section.3.6.p.3">Common CoAP implementations may generate large tokens, even if shorter tokens could be used regarding the LPWAN characteristics. A proxy may be needed to reduce the size of the token before compression.</p>
<p id="rfc.section.3.6.p.4">The size of the compress token sent is known by a combination of the Token Length field and the rule entry. For instance, with the entry below:</p>
<pre>
FID     Pos    DI    TV              MO             CDF
tkl     1      bi    2               equal          not-sent     
token   1      bi    0x00            MSB(12)        LSB(4)
</pre>
<p id="rfc.section.3.6.p.5">The uncompressed token is 2 bytes long, but the compressed size will be 4 bits.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#coap-options" id="coap-options">CoAP options</a>
</h1>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#coap-option-content-format-field" id="coap-option-content-format-field">CoAP option Content-format field.</a>
</h1>
<p id="rfc.section.4.1.p.1">This field is unidirectional and must not be set to bidirectional in a rule entry.  It is used only by the server to inform the client about of the payload type and is never found in client requests.</p>
<p id="rfc.section.4.1.p.2">If single value is expected by the client, the TV contains that value and MO is set to &#8220;equal&#8221; and the CDF is set to &#8220;not-sent&#8221;. The examples below describe the rules for an ES acting as a server.</p>
<pre>
FID     Pos    DI    TV              MO             CDF
content 1      up    value           equal          not-sent
</pre>
<p id="rfc.section.4.1.p.3">If several possible value are expected by the client, a matching-list can be used.</p>
<pre>
FID     Pos    DI    TV              MO             CDF
content 1      up    {0:50,1:41}     match-mapping  mapping-sent
</pre>
<p id="rfc.section.4.1.p.4">Otherwise the value can be sent.The value-sent CDF in the compressor do not send the option type and the decompressor reconstruct it regarding the position in the rule.</p>
<pre>
FID     Pos    DI    TV              MO             CDF
content 1      up                    ignore         value-sent
</pre>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#coap-option-accept-field" id="coap-option-accept-field">CoAP option Accept field</a>
</h1>
<p id="rfc.section.4.2.p.1">This field is unidirectional and must not be set to bidirectional in a rule entry.  It is used only by the client to inform of the possible payload type and is never found in server response.</p>
<p id="rfc.section.4.2.p.2">The number of accept options is not limited and can vary regarding the usage. To be selected a rule must contain the exact number about accept options with their positions. Since the order in which the Accept value are sent, the position order can be modified. The rule below</p>
<pre>
FID     Pos    DI    TV              MO             CDF
accept  1      up    41              egal           not-sent
accept  2      up    50              egal           not-sent
</pre>
<p id="rfc.section.4.2.p.3">will be selected only if two accept options are in the CoAP header if this order.</p>
<p id="rfc.section.4.2.p.4">The rule below:</p>
<pre>
FID     Pos    DI    TV              MO             CDF
accept  0      up    41              egal           not-sent
accept  0      up    50              egal           not-sent
</pre>
<p id="rfc.section.4.2.p.5">will accept a-only CoAP messages with 2 accept options, but the order will not influence the rule selection. The decompression will reconstruct the header regarding the rule order.</p>
<p id="rfc.section.4.2.p.6">Otherwise a matching-list can be applied to the different values, in that case the order is important to recover the appropriate value and the position must be clearly indicate.</p>
<pre>
FID     Pos    DI    TV              MO             CDF
accept 1      up    {0:50,1:41}     match-mapping  mapping-sent
accept 2      up    {0:50,1:61}     match-mapping  mapping-sent
accept 3      up    {0:61,1:71}     match-mapping  mapping-sent
</pre>
<p id="rfc.section.4.2.p.7">Finally, the option  can be  explicitly sent.</p>
<pre>
FID     Pos    DI    TV              MO             CDF
accept  1      up                    ignore         value-sent
</pre>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#coap-option-max-age-field-coap-option-uri-host-and-uri-port-fields" id="coap-option-max-age-field-coap-option-uri-host-and-uri-port-fields">CoAP option Max-Age field, CoAP option Uri-Host and Uri-Port fields</a>
</h1>
<p id="rfc.section.4.3.p.1">This field is unidirectional and must not be set to bidirectional in a rule entry.  It is used only by the server to inform of the caching duration and is never found in client requests.</p>
<p id="rfc.section.4.3.p.2">If the duration is known by both ends, value can be elided on the LPWAN.</p>
<p id="rfc.section.4.3.p.3">A matching list can be used if some wellknown values are defined.</p>
<p id="rfc.section.4.3.p.4">Otherwise the option length and value can be sent on the LPWAN.</p>
<p id="rfc.section.4.3.p.5">[[note: we can reduce (or create a new option) the unit to minute, second is small for LPWAN ]]</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#coap-option-uri-path-and-uri-query-fields" id="coap-option-uri-path-and-uri-query-fields">CoAP option Uri-Path and Uri-Query fields</a>
</h1>
<p id="rfc.section.5.p.1">This fields are unidirectional and must not be set to bidirectional in a rule entry.  They are used only by the client to access to a specific resource and are never found in server response.</p>
<p id="rfc.section.5.p.2">The Matching Operator behavior has not changed, but the value must take a position value, if the entry is repeated :</p>
<div id="rfc.figure.2"></div>
<div id="Fig-MOposition"></div>
<pre>
FID       Pos    DI    TV              MO             CDF
URI-Path  1      up    foo             equal          not-sent
URI-Path  2      up    bar             equal          not-sent
</pre>
<p class="figure">Figure 2: Position entry.</p>
<p id="rfc.section.5.p.3">For instance, the  rule <a href="#Fig-MOposition" class="xref">Figure 2</a> matches with /foo/bar, but not /bar/foo.</p>
<p id="rfc.section.5.p.4">When the length is not clearly indicated in the rule, the value length must be sent with the field data, which means for CoAP to send directly the CoAP option with length and value.</p>
<p id="rfc.section.5.p.5">For instance for a CoMi path /c/X6?k=&#8221;eth0&#8221; the rule can be set to:</p>
<div id="rfc.figure.3"></div>
<div id="Fig-CoMicompress"></div>
<pre>
FID       Pos    DI    TV              MO             CDF
URI-Path  1      up    c               equal          not-sent
URI-Path  2      up                    ignore         value-sent
URI-Query 1      up    k=              MSB (16)       LSB 
</pre>
<p class="figure">Figure 3: CoMi URI compression</p>
<p><a href="#Fig-CoMicompress" class="xref">Figure 3</a> shows the parsing and the compression of the URI. where c is not sent.  The second element is sent with the length (i.e. 0x2 X 6) followed by the query option (i.e. 0x05 &#8220;eth0&#8221;).</p>
<p id="rfc.section.5.p.7">A Mapping list can be used to reduce size of variable Paths or Queries. In that case, to optimize the compression, several elements can be regrouped into a single entry.  Numbering of elements do not change, MO comparison is set with the first element of the matching.</p>
<div id="rfc.figure.4"></div>
<div id="Fig--complex-path"></div>
<pre>
FID       Pos    DI    TV              MO             CDF
URI-Path  1      up    {0:"/c/c",      equal          not-sent
                        1:"/c/d"
URI-Path  3      up                    ignore         value-sent
URI-Query 1      up    k=              MSB (16)       LSB 
</pre>
<p class="figure">Figure 4: complex path example</p>
<p id="rfc.section.5.p.8">For instance, the following Path /foo/bar/variable/stable can leads to the rule defined <a href="#Fig--complex-path" class="xref">Figure 4</a>.</p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#coap-option-proxy-uri-and-proxy-scheme-fields" id="coap-option-proxy-uri-and-proxy-scheme-fields">CoAP option Proxy-URI and Proxy-Scheme fields</a>
</h1>
<p id="rfc.section.5.1.p.1">These fields are unidirectional and must not be set to bidirectional in a rule entry.  They are used only by the client to access to a specific resource and are never found in server response.</p>
<p id="rfc.section.5.1.p.2">If the field value must be sent, TV is not set, MO is set to &#8220;ignore&#8221; and CDF is set to &#8220;value-sent. A mapping can also be used.</p>
<p id="rfc.section.5.1.p.3">Otherwise the TV is set to the value, MO is set to &#8220;equal&#8221; and CDF is set to &#8220;not-sent&#8221;</p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#coap-option-etag-if-match-if-none-match-location-path-and-location-query-fields" id="coap-option-etag-if-match-if-none-match-location-path-and-location-query-fields">CoAP option ETag, If-Match, If-None-Match, Location-Path and Location-Query fields</a>
</h1>
<p id="rfc.section.5.2.p.1">These fields are unidirectional.</p>
<p id="rfc.section.5.2.p.2">These fields values cannot be stored in a rule entry. They must always be sent with the request.</p>
<p id="rfc.section.5.2.p.3">[[Can include OSCOAP Object security in that category ]]</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#other-rfcs" id="other-rfcs">Other RFCs</a>
</h1>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#block" id="block">Block</a>
</h1>
<p id="rfc.section.6.1.p.1">Block option should be avoided in LPWAN. The minimum size of 16 bytes can be incompatible with some LPWAN technologies.</p>
<p id="rfc.section.6.1.p.2">[[Note: do we recommand LPWAN fragmentation since the smallest value of 16 is too big?]]</p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#observe" id="observe">Observe</a>
</h1>
<p><a href="#rfc7641" class="xref">[rfc7641]</a> defines the Observe option. The TV is not set, MO is set to &#8220;ignore&#8221; and the CDF is set to &#8220;value-sent&#8221;. SCHC does not limit the maximum size for this option (3 bytes).  To reduce the transmission size either the Thing implementation should limit the value increase or a proxy can be used limit the increase.</p>
<p id="rfc.section.6.2.p.2">Since RST message may be sent to inform a server that the client do not require Observe response, a rule must allow the transmission of this message.</p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> <a href="#no-response" id="no-response">No-Response</a>
</h1>
<p><a href="#rfc7967" class="xref">[rfc7967]</a>  defines an No-Response option limiting the responses made by a server to a request. If the value is not by both ends, then TV is set to this value, MO is set to &#8220;equal&#8221; and CDF is set to &#8220;not-sent&#8221;.</p>
<p id="rfc.section.6.3.p.2">Otherwise, if the value is changing over time, TV is not set, MO is set to &#8220;ignore&#8221; and CDF to &#8220;value-sent&#8221;. A matching list can also be used to reduce the size.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#protocol-analysis" id="protocol-analysis">Protocol analysis</a>
</h1>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#examples-of-coap-header-compression" id="examples-of-coap-header-compression">Examples of CoAP header compression</a>
</h1>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> <a href="#mandatory-header-with-con-message" id="mandatory-header-with-con-message">Mandatory header with CON message</a>
</h1>
<p id="rfc.section.8.1.p.1">In this first scenario, the LPWAN compressor receives from outside client a POST message, which is immediately acknowledged by the Thing. For this simple scenario, the rules are described <a href="#Fig-CoAP-header-1" class="xref">Figure 5</a>.</p>
<div id="rfc.figure.5"></div>
<div id="Fig-CoAP-header-1"></div>
<pre>
 rule id 1
+-------------+------+---------+-------------+-----+----------------+
| Field       |TV    |MO       |CDF          |dir  | Sent           |
+=============+======+=========+=============+=====+================+
|CoAP version | 01   |equal    |not-sent     |bi   |                |
|CoAP Type    |      |ignore   |value-sent   |bi   |TT              |
|CoAP TKL     | 0    |equal    |not-sent     |bi   |                |
|CoAP Code    | ML1  |match-map|matching-sent|bi   |  CC CCC        |
|CoAP MID     | 0000 |MSB(7 )  |LSB(9)       |bi   |         M-ID   |
|CoAP Uri-Path| path |equal 1  |not-sent     |down |                |
+-------------+------+---------+-------------+-----+----------------+
</pre>
<p class="figure">Figure 5: CoAP Context to compress header without token</p>
<p id="rfc.section.8.1.p.2">The version  and Token Length fields are elided. Code has shrunk to 5 bits using the matching list (as the one given <a href="#Fig--example-code-mapping" class="xref">Figure 1</a>: 0.01 is value 0x01 and 2.05 is value 0x0c) Message-ID has shrunk to 9 bits to preserve alignment on byte boundary. The most significant bit must be set to 0 through a CoAP proxy. Uri-Path contains a single element indicated in the matching operator.</p>
<p><a href="#Fig-CoAP-3" class="xref">Figure 6</a> shows the time diagram of the exchange. A LPWAN Application Server sends a CON message. Compression reduces the header sending only the Type, a mapped code and the least 9 significant bits of Message ID. The receiver decompresses the header. .</p>
<p id="rfc.section.8.1.p.4">The CON message is a request, therefore the LC process to a dynamic mapping.  When the ES receives the ACK message, this will not initiate locally a  message ID mapping since it is a response.  The LC receives the ACK and uncompressed it to restore the original value.  Dynamic Mapping context lifetime follows the same rules as message ID duration.</p>
<div id="rfc.figure.6"></div>
<div id="Fig-CoAP-3"></div>
<pre>
                   End System               LPWA LC
                        |                     |
                        |        rule id=1    |&lt;----------------------
                        |&lt;--------------------| +-+-+--+----+--------+
  &lt;-------------------- |  TTCC CCCM MMMM MMMM| |1|0| 4|0.01| 0x0034 |
 +-+-+--+----+--------+ |  0000 0010 0011 0100| |  0xb4   p    a   t |
 |1|0| 1|0.01| 0x0034 | |                     | |  h   |
 |  0xb4   p    a   t | |                     | +------+
 |  h   |               |                     |     
 +------+               |                     |   
                        |                     |    
                        |                     |    
-----------------------&gt;|       rule id=1     |
+-+-+--+----+--------+  |--------------------&gt;|
|1|2| 0|2.05| 0x0034 |  |  TTCC CCCM MMMM MMMM|------------------------&gt;
+-+-+--+----+--------+  |  1001 1000 0011 0100| +-+-+--+----+--------+
                        |                     | |1|2| 0|2.05| 0x0034 |
                        v                     v +-+-+--+----+--------+

</pre>
<p class="figure">Figure 6: Compression with global addresses</p>
<p id="rfc.section.8.1.p.5">The message can be further optimized by setting some fields unidirectional, as described in <a href="#Fig-CoAP-header-1-direc" class="xref">Figure 7</a>. Note that Type is no more sent in the compressed format, Compressed Code size in not changed in that example (8 values are needed to code all the requests and 21 to code all the responses in the matching list <a href="#Fig--example-code-mapping" class="xref">Figure 1</a>)</p>
<div id="rfc.figure.7"></div>
<div id="Fig-CoAP-header-1-direc"></div>
<pre>
 rule id 1
+-------------+------+---------+-------------+---+----------------+
| Field       |TV    |MO       |CDF          |dir| Sent           |
+=============+======+=========+=============+===+================+
|CoAP version | 01   |equal    |not-sent     |bi |                |
|CoAP Type    | CON  |equal    |not-sent     |dw |                |
|CoAP Type    | ACK  |equal    |not-sent     |up |                |
|CoAP TKL     | 0    |equal    |not-sent     |bi |                |
|CoAP Code    | ML2  |match-map|mapping-sent |dw |CCCC C          |
|CoAP Code    | ML3  |match-map|mapping-sent |up |CCCC C          |
|CoAP MID     | 0000 |MSB(5)   |LSB(11)      |bi |       M-ID     |
|CoAP Uri-Path| path |equal 1  |not-sent     |dw |                |
+-------------+------+---------+-------------+---+----------------+

ML1 = {CON : 0, ACK:1} ML2 = {POST:0, 2.04:1, 0.00:3}

</pre>
<p class="figure">Figure 7: CoAP Context to compress header without token</p>
<h1 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> <a href="#complete-exchange" id="complete-exchange">Complete exchange</a>
</h1>
<p id="rfc.section.8.2.p.1">In that example, the Thing is using CoMi and sends queries for 2 SID.</p>
<pre>
  CON 
  MID=0x0012     |                         |
  POST           |                         |   
  Accept X       |                         | 
  /c/k=AS        |------------------------&gt;|
                 |                         |
                 |                         |
                 |&lt;------------------------|  ACK MID=0x0012
                 |                         |  0.00
                 |                         |
                 |                         |
                 |&lt;------------------------|   CON
                 |                         |   MID=0X0034
                 |                         |   Content-Format X
ACK MID=0x0034   |------------------------&gt;|
0.00           

</pre>
<pre>
 rule id 3
+-------------+------+---------+-------------+---+----------------+
| Field       |TV    |MO       |CDF          |dir| Sent           |
+=============+======+=========+=============+===+================+
|CoAP version | 01   |equal    |not-sent     |bi |                |
|CoAP Type    | CON  |equal    |not-sent     |up |                |
|CoAP Type    | ACK  |equal    |not-sent     |dw |                |
|CoAP TKL     | 1    |equal    |not-sent     |bi |                |
|CoAP Code    | POST |equal    |not-sent     |up |                |
|CoAP Code    | 0.00 |equal    |not-sent     |dw |                |
|CoAP MID     | 0000 |MSB(8)   |LSB          |bi |MMMMMMMM        |
|CoAP Token   |      |ignore   |send-value   |up |TTTTTTTT        |
|CoAP Uri-Path| /c   |equal 1  |not-sent     |dw |                |
|CoAP Uri-query ML4  |equal 1  |not-sent     |dw |P               |
|CoAP Content | X    |equal    |not-sent     |up |                |
+-------------+------+---------+-------------+---+----------------+

 rule id 4
+-------------+------+---------+-------------+---+----------------+
| Field       |TV    |MO       |CDF          |dir| Sent           |
+=============+======+=========+=============+===+================+
|CoAP version | 01   |equal    |not-sent     |bi |                |
|CoAP Type    | CON  |equal    |not-sent     |dw |                |
|CoAP Type    | ACK  |equal    |not-sent     |up |                |
|CoAP TKL     | 1    |equal    |not-sent     |bi |                |
|CoAP Code    | 2.05 |equal    |not-sent     |dw |                |
|CoAP Code    | 0.00 |equal    |not-sent     |up |                |
|CoAP MID     | 0000 |MSB(8)   |LSB          |bi |MMMMMMMM        |
|CoAP Token   |      |ignore   |send-value   |dw |TTTTTTTT        |
|COAP Accept  | X    |equal    |not-sent     |dw |                |
+-------------+------+---------+-------------+---+----------------+


alternative rule:

 rule id 4
+-------------+------+---------+-------------+---+----------------+
| Field       |TV    |MO       |CDF          |dir| Sent           |
+=============+======+=========+=============+===+================+
|CoAP version | 01   |equal    |not-sent     |bi |                |
|CoAP Type    | ML1  |match-map|match-sent   |bi |t               |
|CoAP TKL     | 1    |equal    |not-sent     |bi |                |
|CoAP Code    | ML2  |match-map|match-sent   |up | cc             |
|CoAP Code    | ML3  |match-map|match-sent   |dw | cc             |
|CoAP MID     | 0000 |MSB(8)   |LSB          |bi |MMMMMMMM        |
|CoAP Token   |      |ignore   |send-value   |dw |TTTTTTTT        |
|CoAP Uri-Path| /c   |equal 1  |not-sent     |dw |                |
|CoAP Uri-query ML4  |equal 1  |not-sent     |dw |P               |
|CoAP Content | X    |equal    |not-sent     |up |                |
|COAP Accept  | x    |equal    |not-sent     |dw |                |
+-------------+------+---------+-------------+---+----------------+

ML1 {CON:0, ACK:1} ML2 {POST:0, 0.00: 1} ML3 {2.05:0, 0.00:1}
ML4 {NULL:0, k=AS:1, K=AZE:2}

</pre>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.toutain-lpwan-ipv6-static-context-hc">[I-D.toutain-lpwan-ipv6-static-context-hc]</b></td>
<td class="top">
<a>Minaburo, A.</a> and <a>L. Toutain</a>, "<a href="https://tools.ietf.org/html/draft-toutain-lpwan-ipv6-static-context-hc-00">LPWAN Static Context Header Compression (SCHC) for IPv6 and UDP</a>", Internet-Draft draft-toutain-lpwan-ipv6-static-context-hc-00, September 2016.</td>
</tr>
<tr>
<td class="reference"><b id="rfc7252">[rfc7252]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Hartke, K.</a> and <a>C. Bormann</a>, "<a href="https://tools.ietf.org/html/rfc7252">The Constrained Application Protocol (CoAP)</a>", RFC 7252, DOI 10.17487/RFC7252, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="rfc7641">[rfc7641]</b></td>
<td class="top">
<a>Hartke, K.</a>, "<a href="https://tools.ietf.org/html/rfc7641">Observing Resources in the Constrained Application Protocol (CoAP)</a>", RFC 7641, DOI 10.17487/RFC7641, September 2015.</td>
</tr>
<tr>
<td class="reference"><b id="rfc7967">[rfc7967]</b></td>
<td class="top">
<a>Bhattacharyya, A.</a>, <a>Bandyopadhyay, S.</a>, <a>Pal, A.</a> and <a>T. Bose</a>, "<a href="https://tools.ietf.org/html/rfc7967">Constrained Application Protocol (CoAP) Option for No Server Response</a>", RFC 7967, DOI 10.17487/RFC7967, August 2016.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ana Minaburo</span> 
	  <span class="n hidden">
		<span class="family-name">Minaburo</span>
	  </span>
	</span>
	<span class="org vcardline">Acklio</span>
	<span class="adr">
	  <span class="vcardline">2bis rue de la Chataigneraie</span>

	  <span class="vcardline">
		<span class="locality">35510 Cesson-Sevigne Cedex</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">France</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ana@ackl.io">ana@ackl.io</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Laurent Toutain</span> 
	  <span class="n hidden">
		<span class="family-name">Toutain</span>
	  </span>
	</span>
	<span class="org vcardline">Institut MINES TELECOM ; IMT Atlantique</span>
	<span class="adr">
	  <span class="vcardline">2 rue de la Chataigneraie</span>
<span class="vcardline">CS 17607</span>

	  <span class="vcardline">
		<span class="locality">35576 Cesson-Sevigne Cedex</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">France</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:Laurent.Toutain@imt-atlantique.fr">Laurent.Toutain@imt-atlantique.fr</a></span>

  </address>
</div>

  <div class="github-fork-ribbon-wrapper"><div class="github-fork-ribbon"><a href="https://github.com/lp-wan/coap-compression">Fork me on GitHub</a></div></div>
</body>
</html>
